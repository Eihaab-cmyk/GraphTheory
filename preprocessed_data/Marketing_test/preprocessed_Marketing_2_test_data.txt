causal machin learn market | heinrich kögel | mediumopen appsign upsign inwritesign upsign incaus machin learn marketingheinrich kögel·follow10 min read·jul 31 , 2023 -- 13listensharethi articl provid case studi demonstr leverag causal machin learn better decision-mak marketing.understand caus effect crucial busi world . come price , exampl , import know custom chang buy behavior price adjust . figur market campaign worth continu , need understand actual impact kpi care about.it may seem obviou understand caus effect crucial address kind question . realiti , peopl often confus causat mere correl , lead costli mistak decision-mak . let ’ look exampl illustr point.th costli mistak confus correl causationimagin ice cream parlor decid advertis local newspap summer . place ad , owner notic increas sale conclud ad campaign huge success . , sale much higher campaign compar rest year . thu , owner plan spend money newspap ad . howev , owner realiz ice cream sale alway higher summer , regardless ad . besid , hardli anyon read local newspap anymor , ad realli make differ . statist term , owner confus correl causat . ad campaign correl higher sale took place summer . actual caus increas . confus lead owner make expens decis keep run ad campaign . although styliz exampl , highlight crucial understand causal relationship confus plain correl make busi decisions.sourc : http : //xkcd.com/552/a/b test alway feasiblein data scienc busi , commonli use approach estim causal effect conduct a/b test . tradit a/b test date back mani centuri , origin medicin . term a/b test includ experi , random control trial ( rct ) , split test . fundament concept behind a/b test revolv around random assign unit observ , custom , two distinct group . one group , refer treatment group , receiv specif intervent treatment , market email . group , known control group , receiv treatment . compar treatment group control group , determin causal effect intervent kpi interest due random assignment.howev , a/b test valuabl tool mani set , alway feasibl real-world scenario . exampl , probabl advis compani randomli alloc market budget across market test effect market strategi . addit situat a/b test may costli riski , also scenario a/b test time-consum obtain action insight even prohibit law due ethic considerations.caus machin learn learn naturally-collect datain circumst , causal machin learn come rescu valuabl solut . rel new field combin rigor statist econometr theori , develop decad , flexibl , novel machin learn method . causal machin learn techniqu enabl estim causal effect without reli a/b test . instead , leverag “ natur collect ” data , inform custom price , estim causal effects.on power approach toolkit causal machin learn method doubl machin learn approach chernozhukov et al . ( 2018 ) . sinc develop , approach extend numer research paper . allow estim causal effect reliabl way desir statist properti . user guid section doubleml packag provid great introduct method.in follow , present case studi leverag doubl machin learn approach make inform decis market . case studi inspir real-world consult project conduct jointli multipl medium-s larg compani . confidenti reason , data use case studi simulated.cas studi : estim effect market campaignin case studi , examin techgear , compani sell comput equip busi . past year , techgear ran market campaign offer discount certain custom firm . , market manag think whether continu provid discount . make inform decis , want assess effect offer discount determin actual boost sale . ideal , would like conduct a/b test measur impact . unfortun , conduct test feasibl due time budget constraints.thu , evalu campaign ’ effect , team initi consid compar averag sale custom firm receiv discount . howev , discuss evalu campaign , one manag mention larger firm , measur number employe , like receiv discount . addit , techgear higher sale larger firm . rais concern among data scientist . explain simpli compar sale firm receiv discount could lead incorrect conclusions.confound variabl lead fals conclus naiv estimationsto understand comparison would mislead , let ’ look follow figur illustr relationship receiv discount , firm size , sale . interest understand effect receiv discount sale ( arrow 1 ) . howev , also know firm size influenc likelihood receiv discount ( arrow 2 ) , larger firm tend result higher sale ( arrow 3 ) . causal terminolog , refer firm size “ confound variabl ” associ discount sale . account influenc confound variabl estim effect discount , obtain incorrect estimate.w want estim effect discount sale . firm size confound variable.to illustr , consid extrem exampl . let ’ say techgear ’ averag sale larg firm $ 100 , sale small firm $ 50 . furthermor , let ’ assum discount effect sale , larg firm receiv discount small firm . tri determin effect discount sale compar averag sale firm receiv discount , would obtain incorrect result . would effect compar larg small firm . despit assumpt discount effect , would mistakenli conclud discount increas sale $ 100- $ 50 = $ 50 per firm . isol causal effect , need “ control ” “ hold constant ” confound variabl estimation.back brainstorm session team techgear , thing becom even complic anoth market manag point discount also frequent given first quarter year custom firm typic made purchas techgear . manag also uncertain whether may confound variabl , could simultan influenc receiv discount sales.caus machin learn estim campaign ’ effectivenessfortun , techgear comprehens custom databas contain variou custom characterist , includ sale , firm size , whether firm receiv discount . enabl data scientist employ doubl machin learn approach estim effect discount sales.specif , decid estim partial linear regress model , consist two main equat . model express follow : equat ( 1 ) repres relationship interest , connect sale receipt discount . coeffici θ repres effect receiv discount sale . vector x includ variabl suspect confound variabl , mean variabl influenc sale receipt discount . function g flexibl function model relationship variabl x sale . second equat serv “ helper equat ” necessari doubl machin learn approach abl leverag modern machin learn techniqu estim causal effect discount sale . equat captur relationship receipt discount set potenti confound x . variabl ɛ η random nois term . detail inform theori behind doubl machin learn approach , pleas see chernozhukov et al . ( 2018 ) user guid doubleml package.aft examin custom databas , data scientist discov approxim 3000 custom databas . decid includ five variabl potenti confound variabl model : firm size ( measur number employe ) , quarter year compani made purchas techgear , sale prior year discount campaign , firm ’ headquart locat us , number market firm operates.onc determin variabl incorpor model , util doubleml packag estim effect discount . estim process follow simpl step . firstli , creat data object doubl machin learn estim . specifi main variabl analysi data , alreadi load panda datafram : import panda pdimport doubleml dmlfrom sklearn.ensembl import randomforestclassifi , randomforestregressornp.random.se ( 123 ) # specifi potenti confounderspotential_confound = [ 'size ' , 'past_sal ' , 'quarter ' , 'number_markets_act ' , 'headquarters_u ' ] # instanti doubleml data objectdata_dml = dml.doublemldata ( data=df , y_col='sal ' , d_cols='discount ' , x_cols=potential_confound ) next , specifi two learner estim relationship sale potenti confound variabl x , well relationship discount x . model relationship sale x equat ( 1 ) , util random forest regressor . similarli , use random forest classifi captur relationship discount x equat ( 2 ) . use random forest learner , data scientist estim relationship highli flexibl way , without impos strong assumpt function form g m. flexibl allow captur complex pattern interact data , make estim process reliable. # instanti random forest learnersrf_reg = randomforestregressor ( n_estimators=500 ) rf_class = randomforestclassifi ( n_estimators=500 ) # instanti doubleml partial linear regress modeldml_plr = dml.doublemlplr ( obj_dml_data=data_dml , ml_l=rf_regressor , ml_m=rf_classifi ) final , appli fit method print result estimation. # run estimationdml_plr.fit ( ) # print estim resultsdml_plr.summaryth data scientist discov provid discount increas sale approxim $ 3200 per firm , indic valu column “ coef ” . estim highli signific , p-valu 1 % . also quit close true effect $ 3000 specifi simul data case studi ( although data scientist unawar , cours ) . equip result , data scientist schedul next meet market manag present findings.th campaign littl effect — find altern market measur ! thought consider , market manag express satisfact discount posit impact sale . howev , given techgear ’ averag sale firm amount around $ 96,000 , decid need explor market measur substanti effect sale . meet progress , one market manag remain curiou want know estim effect would data scientist appli simpl , naïv mean comparison sale firm receiv discount , without control confound variabl . data scientist respond , case , estim effect would around $ 18,300 . market manag feel reliev data scientist employ causal machin learn estim effect discount . without knowledg , would continu offer discount without realiz minim impact sales.caus matter sound decision-makingthank take time read articl ! articl emphas import understand differ correl causat . make right decis come cause-and-effect relationship , need use appropri method . causal machin learn provid help framework teas causal data gain deeper insights.th case studi present serv illustr power causal machin learn market . howev , import note potenti causal machin learn extend beyond specif scenario . practic , causal machin learn , includ doubl machin learn , appli variou area context . addit learn natur collect data , causal machin learn also util a/b test . exampl , assist develop person decis rule target market strategies.if question thought would like share , pleas feel free comment reach me.acknowledgmentsi thank martin spindler sven klaassen provid valuabl input article.about authorheinrich data scienc manag econom ai . passion leverag data creat valu area dynam price , market , financi forecast plan . heinrich hold phd quantit econom live munich , germani . busi har power data , enjoy explor nearbi alp bike foot.caus machin learningcaus inferencemarketingdata sciencedoubl machin learn -- -- 13followwritten heinrich kögel156 followersdata scienc economistfollowhelpstatusaboutcareersblogprivacytermstext speechteam