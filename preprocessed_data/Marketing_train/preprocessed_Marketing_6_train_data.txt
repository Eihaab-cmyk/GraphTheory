custom segment use k-mean algorithm python | mediumopen appsign upsign inwritesign upsign instep step custom segment use k-mean pythonuğur savcı·follow11 min read·jan 28 , 2022 -- 5listenshareseg custom better marketing.t contentsintroduct — custom segment ? busi scenarioexplor datasetdata preprocessingk-mean segmentationpca k-mean better visualizationconclusionintroductionlet ’ say , decid buy t-shirt brand onlin . ever thought els bought t-shirt ? peopl , similar , right ? age , hobbi , gender , etc.in market , compani basic tri find t-shirt peopl ! wait ? ? cours , data ! custom segment simpl ! actual tri find group custom base common characterist age , gender , live area , spend behavior , etc . market custom effectively.let ’ dive segment project ! busi scenariosuppos work data scientist fmcg compani want segment custom help market depart launch new product sale base segment . therefor save time money market specif group custom select products.how collect data way ? data collect loyalti card use checkout : ) util k-mean pca algorithm project see defin new group custom ! understand data import ! start project , need understand busi problem dataset first.let ’ see variabl ( featur ) dataset.vari descriptionid : show uniqu identif customer.sex : biolog sex ( gender ) custom . dataset , 2 differ options.0 : male1 : femalemarit statu : marit statu customer.0 : single1 : non-singl ( divorc / separ / marri / widow ) age : age custom year , calcul current year minu year birth custom time creation dataset18 min valu ( lowest age observ dataset ) 76 max valu ( highest age observ dataset ) educ : level educ customer.0 : / unknown1 : high school2 : university3 : graduat schoolincom : self-report annual incom us dollar customer.35832 min valu ( lowest incom observ dataset ) 309364 max valu ( highest incom observ dataset ) occup : categori occup customer.0 : unemployed/unskilled1 : skill employe / official2 : manag / self-employ / highli qualifi employe / officersettl size : size citi custom live in.0 : small city1 : mid-siz city2 : big cityw dataset know busi problem . , let ’ start code ! import librariesin project , need friend help along way ! let introduc , # # # data analysi manipul import panda pd import numpi np # # # data visualizationimport matplotlib.pyplot pltimport seaborn snssns.set ( ) # # style # # # data standard model k-mean pcafrom sklearn.preprocess import standardscalerfrom sklearn.clust import kmeansfrom sklearn.decomposit import pca3 . explor datasetdf= pd.read_csv ( 'segment data.csv ' , index_col = 0 ) part consist understand data help descript analysi visualization.df.head ( ) df.head ( ) outputw also appli describ method see descript statist columns.df.describ ( ) see mean age incom 35.90 120954 respect . describ method use numer columns.df.info ( ) df.info ( ) method return inform datafram includ index data type column , non-nul valu , memori usage.w see miss valu dataset variabl integer.a good way get initi understand relationship differ variabl explor correlate.w calcul correl variabl use corr method panda library.plt.figur ( figsize= ( 12,9 ) ) sns.heatmap ( df.corr ( ) , annot=tru , cmap='rdbu ' ) plt.titl ( 'correl heatmap ' , fontsize=14 ) plt.ytick ( rotat =0 ) plt.show ( ) let ’ explor correlation.w see strong correl educ age . word , older peopl tend highli educated.how incom occup ? correl 0.68 . mean higher salari , like higher-level occup manager.correl matrix use tool analyz relationship features.now , understand dataset gener idea it.next section segment . , need scale data first.4 . data preprocessingw need appli standard featur use distance-bas machin learn model k-mean , knn.in gener , want treat featur equal achiev transform featur way valu fall within numer rang [ 0:1 ] .thi process commonli refer standardization.standardizationnow clear . time perform standard python.scal = standardscal ( ) df_std = scaler.fit_transform ( df ) , set start build segment model k-mean ! df_std = pd.datafram ( data = df_std , column = df.column ) build segment modelbefor appli k-mean algorithm need choos mani cluster would like have.but ? two compon . within cluster sum squar ( wcss ) elbow method.wcss = [ ] rang ( 1,11 ) : kmeans_pca = kmean ( n_cluster = , init = ' k-means++ ' , random_st = 42 ) kmeans_pca.fit ( scores_pca ) wcss.append ( kmeans_pca.inertia_ ) store within cluster sum squar valu wcss list.let ’ visual them.plt.figur ( figsiz = ( 10,8 ) ) plt.plot ( rang ( 1 , 11 ) , wcss , marker = ' ' , linestyl = '- . ' , color='r ' ) plt.xlabel ( 'number cluster ' ) plt.ylabel ( 'wcss ' ) plt.titl ( ' k-mean cluster ' ) plt.show ( ) elbow graph four-clust mark . place graph steepli declin smooth afterward.let ’ perform k-mean cluster 4 clusters.kmean = kmean ( n_cluster = 4 , init = ' k-means++ ' , random_st = 42 ) fit model datasetkmeans.fit ( df_std ) # creat new data frame origin featur add new column assign cluster point.df_segm_kmeans= df_std.copi ( ) df_std [ ‘ segment k-mean ’ ] = kmeans.labels_w see segment dataset.let ’ group custom cluster see averag valu variable.df_segm_analysi = df_std.groupbi ( [ 'segment k-mean ' ] ) .mean ( ) df_segm_analysisit ’ time interpret new dataset , let ’ start first segment , almost number men women averag age 56 . compar cluster , realiz oldest segment.for second segment , say , segment lowest valu annual salary.they live almost exclus small citieswith low incom live small citi , seem segment peopl fewer opportunities.let ’ carri third segment , youngest segment averag age 29 . medium level educ averag income.they also seem averag everi paramet label segment averag standard.fin , come fourth segment , compris almost entir men , less 20 percent relationships.look number , observ rel low valu educ , pair high valu incom occupation.th major segment live big middle-s cities.let ’ label segment accord relevance.df_segm_analysis.renam ( { 0 : 'well-off ' , 1 : 'fewer-opportun ' , 2 : 'standard ' , 3 : 'career focus ' } ) final , creat plot visual segment.x_axi = df_std [ 'age ' ] y_axi = df_std [ 'incom ' ] plt.figur ( figsiz = ( 10 , 8 ) ) sns.scatterplot ( x_axi , y_axi , hue = df_std [ 'label ' ] , palett = [ ' g ' , ' r ' , ' c ' , 'm ' ] ) plt.titl ( 'segment k-mean ' ) plt.show ( ) see green segment well clearli separ highest age incom . three group together.w conclud k-mean decent job ! howev , ’ hard separ segment other.in next section , combin pca k-mean tri get better result.pca k-mean better visualizationwhat appli dimension reduct simplifi problem.w choos reason compon order obtain better cluster solut standard k-mean . aim see nice clear plot segment groups.pca = pca ( ) pca.fit ( df_std ) , let ’ see explain varianc ratio component.pca.explained_variance_ratio_w observ first compon explain around 36 % variabl data . second one 26 % on.w plot cumul sum explain variance.plt.figur ( figsiz = ( 12,9 ) ) plt.plot ( rang ( 1,8 ) , pca.explained_variance_ratio_.cumsum ( ) , marker = ' ' , linestyl = ' -- ' ) plt.titl ( 'explain varianc compon ' ) plt.xlabel ( 'number compon ' ) plt.ylabel ( 'cumul explain varianc ' ) well , choos right number compon ? answer right wrong answer that.but , rule thumb keep least 70 80 percent explain variance.80 % varianc data explain first 3 compon . let ’ keep first 3 compon analysis.pca = pca ( n_compon = 3 ) pca.fit ( df_std ) pca.components_th result 3 7 array . reduc futur three compon origin seven valu explain shape valu show so-cal loadings.hey , minut , load ? load correl origin variabl component.for instanc , first valu array show load first featur first component.let ’ put inform panda data frame see nice . column seven origin featur row three compon pca gave us.df_pca_comp = pd.datafram ( data = pca.components_ , column = df.column , index = [ 'compon 1 ' , 'compon 2 ' , 'compon 3 ' ] ) df_pca_compplt.figur ( figsize= ( 12,9 ) ) sns.heatmap ( df_pca_comp , vmin = -1 , vmax = 1 , cmap = 'rdbu ' , annot = true ) plt.ytick ( [ 0 , 1 , 2 ] , [ 'compon 1 ' , 'compon 2 ' , 'compon 3 ' ] , rotat = 45 , fontsiz = 12 ) plt.titl ( 'compon vs origin featur ' , fontsiz = 14 ) plt.show ( ) see posit correl component1 age , incom , occup settlement size . strictli relat career person . compon show career focu individual.for second compon sex , marit statu educ far promin determinants.for final compon , realiz age , marit statu , occup import featur . observ marit statu occup load neg still important.now , idea new variabl ( compon ) . clearli see relationship compon variables.let ’ transform data save scores_pca.pca.transform ( df_std ) scores_pca = pca.transform ( df_std ) k-mean cluster pcaour new dataset readi ! ’ time appli k-mean brand new dataset 3 components.it simpl ! follow step standard k-means.wcss = [ ] rang ( 1,11 ) : kmeans_pca = kmean ( n_cluster = , init = ' k-means++ ' , random_st = 42 ) kmeans_pca.fit ( scores_pca ) wcss.append ( kmeans_pca.inertia_ ) see optim cluster number within sum squar 4.kmeans_pca = kmean ( n_cluster = 4 , init = ' k-means++ ' , random_st = 42 ) kmeans_pca.fit ( scores_pca ) k-mean algorithm learnt new compon creat 4 cluster . would like see old dataset new compon label .df_segm_pca_kmean = pd.concat ( [ df.reset_index ( drop = true ) , pd.datafram ( scores_pca ) ] , axi = 1 ) df_segm_pca_kmeans.columns.valu [ -3 : ] = [ 'compon 1 ' , 'compon 2 ' , 'compon 3 ' ] df_segm_pca_kmean [ 'segment k-mean pca ' ] = kmeans_pca.labels_df_segm_pca_kmeans.head ( ) # calcul mean segments.df_segm_pca_kmeans_freq = df_segm_pca_kmeans.groupbi ( [ 'segment k-mean pca ' ] ) .mean ( ) df_segm_pca_kmeans_freqabov see data group k-mean segment . also convert segment number label see observ number proport segment total observation.df_segm_pca_kmeans_freq [ 'n ob ' ] = df_segm_pca_kmean [ [ 'segment k-mean pca ' , 'sex ' ] ] .groupbi ( [ 'segment k-mean pca ' ] ) .count ( ) df_segm_pca_kmeans_freq [ 'prop ob ' ] = df_segm_pca_kmeans_freq [ 'n ob ' ] / df_segm_pca_kmeans_freq [ 'n ob ' ] .sum ( ) df_segm_pca_kmeans_freq = df_segm_pca_kmeans_freq.renam ( { 0 : 'standard ' , 1 : 'career focus ' , 2 : 'fewer opportun ' , 3 : 'well-off ' } ) df_segm_pca_kmeans_freqw obtain column chang name line codes.now , let ’ plot new segment see differences.a probabl recal , previou four cluster standard , career focus , fewer opportunities.df_segm_pca_kmean [ 'legend ' ] = df_segm_pca_kmean [ 'segment k-mean pca ' ] .map ( { 0 : 'standard ' , 1 : 'career focus ' , 2 : 'fewer opportun ' , 3 : 'well-off ' } ) x_axi = df_segm_pca_kmean [ 'compon 2 ' ] y_axi = df_segm_pca_kmean [ 'compon 1 ' ] plt.figur ( figsiz = ( 10 , 8 ) ) sns.scatterplot ( x_axi , y_axi , hue = df_segm_pca_kmean [ 'legend ' ] , palett = [ ' g ' , ' r ' , ' c ' , 'm ' ] ) plt.titl ( 'cluster pca compon ' ) plt.show ( ) plot k mean cluster solut without pca , abl distinguish green segment , divis base compon much pronounced.that one biggest goal pca reduc number variabl combin bigger ones. “ ’ find custom product , find product customers. ” — seth godinconclusionw segment custom 4 group . readi start choos group base aim market ! segment help market effici term time , money resources.they gain better understand custom 's need want therefor tailor campaign custom segment like purchas products.if want see entir code jupyt notebook , found github.thank read ! sure read ? ’ pick complet exploratori data analysi articl ! complet exploratori data analysi use pythonstep step exploratori data analysi explainedmedium.comar interest data scienc ? let ’ connect linkedin.k meanssegmentationpythonprincip componentmarket -- -- 5followwritten uğur savcı1.3k followersdata scientist | writer | help peopl learn data scienc http : //www.linkedin.com/in/ugur-savci/followhelpstatusaboutcareersblogprivacytermstext speechteam